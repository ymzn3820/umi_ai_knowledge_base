(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["pages-repository-photo"],{"0ffb":function(e,t,i){"use strict";var n=i("dae1"),o=i.n(n);o.a},4158:function(e,t,i){"use strict";i.r(t);var n=i("77cf"),o=i.n(n);for(var a in n)["default"].indexOf(a)<0&&function(e){i.d(t,e,(function(){return n[e]}))}(a);t["default"]=o.a},"4b3a":function(e,t,i){"use strict";i.d(t,"b",(function(){return o})),i.d(t,"c",(function(){return a})),i.d(t,"a",(function(){return n}));var n={uIcon:i("e838").default,uPicker:i("0343").default},o=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("v-uni-view",[i("v-uni-view",{staticClass:"chat_cont"},[i("v-uni-view",{staticClass:"cont_li"},[i("v-uni-view",{staticClass:"top"},[i("v-uni-view",{staticStyle:{display:"flex"}},[i("v-uni-view",{staticClass:"txt",staticStyle:{"margin-right":"15rpx"}},[e._v(e._s(e.name))]),i("u-icon",{attrs:{name:"arrow-down",color:"#000",size:"18"},on:{click:function(t){arguments[0]=t=e.$handleEvent(t),e.chatShow=!0}}})],1),i("v-uni-view",{staticClass:"tag",on:{click:function(t){arguments[0]=t=e.$handleEvent(t),e.toGroup.apply(void 0,arguments)}}},[e._v("分组管理")])],1),i("v-uni-view",{staticClass:"picList"},[i("v-uni-view",{staticClass:"item",on:{click:function(t){arguments[0]=t=e.$handleEvent(t),e.uploadImg.apply(void 0,arguments)}}},[i("v-uni-view",{staticClass:"pic"},[i("v-uni-image",{staticClass:"avatar",attrs:{src:e.upload}})],1),i("v-uni-view",{staticClass:"txt"},[e._v("支持JPG、PNG格式")])],1),e._l(e.qsImg,(function(t,n){return i("v-uni-view",{key:n,staticClass:"item"},[i("v-uni-view",{staticClass:"pic"},[i("v-uni-image",{staticClass:"avatar",attrs:{src:e.getImgUrl(t.pic_url)}}),i("v-uni-view",{staticClass:"del",on:{click:function(i){arguments[0]=i=e.$handleEvent(i),e.delPictures(t.pic_id)}}},[i("v-uni-image",{staticClass:"delicon",attrs:{src:e.del}})],1)],1),i("v-uni-view",{staticClass:"txt"},[e._v(e._s(t.pic_name))]),i("v-uni-view",{staticClass:"editTag",on:{click:function(i){arguments[0]=i=e.$handleEvent(i),e.toEditPhoto(t)}}},[e._v("编辑标签")])],1)}))],2)],1)],1),i("u-picker",{attrs:{show:e.chatShow,columns:e.groupcolumns,closeOnClickOverlay:!0,keyName:"name"},on:{close:function(t){arguments[0]=t=e.$handleEvent(t),e.chatShow=!1},cancel:function(t){arguments[0]=t=e.$handleEvent(t),e.chatShow=!1},confirm:function(t){arguments[0]=t=e.$handleEvent(t),e.version.apply(void 0,arguments)}},model:{value:e.group_name,callback:function(t){e.group_name=t},expression:"group_name"}})],1)},a=[]},"77cf":function(e,t,i){"use strict";(function(e){i("7a82");var n=i("4ea4").default;Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o=n(i("b85c"));i("e9c4"),i("4ec9"),i("d3b7"),i("3ca3"),i("ddb0"),i("14d9");var a=i("5cfd"),r=(i("e4dd"),{data:function(){return{group_name:"",del:e.baseImg+"/xcx/com/message_center/智能体del.png",upload:e.baseImg+"/xcx/com/message_center/upload-trigger.png",qsImg:[],group_id:"",group_order:1,name:"",chatShow:!1,groupList:[],group:[],groupcolumns:[]}},onLoad:function(e){if(this.getGroups(),e.obj){var t=JSON.parse(e.obj);this.group_id=t.id,this.group_order=t.group_order,this.name=t.name}this.getPictures()},onshow:function(){},methods:{version:function(e){console.log(e,"e"),this.group_name=e.value[0].name,this.name=e.value[0].name,this.chatShow=!1,this.group_index=e.indexs[0],this.group_id=e.value[0].id,this.getPictures()},toEditPhoto:function(e){uni.navigateTo({url:"/pages/repository/editPhoto?arr="+JSON.stringify(e)})},toGroup:function(){uni.setStorageSync("resposNum",0),uni.navigateTo({url:"/pages/repository/group"})},getPictures:function(){var e=this;if(""!=this.group_id&&""!=this.group_order){var t={group_id:this.group_id,group_order:this.group_order,user_id:JSON.parse(uni.getStorageSync("userInfo")).user_id};console.log(t,1346),(0,a.getPictures)(t).then((function(t){2e4==t.code?e.qsImg=t.data:e.$api.msg(t.msg)})).catch((function(e){console.log(e)}))}},uploadImg:function(){var t=this;uni.chooseImage({count:1,mediaType:["image"],sourceType:["album","camera"],success:function(i){console.log(i,2225);var n=i.tempFilePaths[0],o=i.tempFiles[0].name;uni.uploadFile({url:e.loginUrl+"/api/user/oss_upload",filePath:n,name:"image",formData:{image:n,oss_dir:"static",cate:"problem_picture"},success:function(e){var i=JSON.parse(e.data);if(2e4==i.code){var n=i.data.new_url,r={group_name:t.name,pic_name:o,pic_url:n,user_id:JSON.parse(uni.getStorageSync("userInfo")).user_id,group_order:t.group_order};(0,a.pictures)(r).then((function(e){2e4==e.code?(t.getGroups(),uni.hideLoading()):(t.$api.msg(e.msg),uni.hideLoading())})).catch((function(e){console.log(e),uni.hideLoading()}))}uni.hideLoading()}})}})},getGroups:function(){var e=this;this.groupList=[];var t={user_id:JSON.parse(uni.getStorageSync("userInfo")).user_id};(0,a.groups)(t).then((function(t){if(2e4==t.code){var i,n=new Map;for(var a in n.set("pictures","图片库"),t.data){var r=t.data[a],u=[];for(var s in r){var c,d=r[s],l=[],f=(0,o.default)(d);try{for(f.s();!(c=f.n()).done;){var p=c.value;l.push(p)}}catch(w){f.e(w)}finally{f.f()}var g={name:s,id:d[0].group_id,group_order:d[0].group_order,children:l};u.push(g)}var v={id:(new Date).getTime(),name:n.get(a),children:u};e.groupList.push(v)}if(uni.getStorageSync("pictures")){var h=uni.getStorageSync("pictures"),m=e.groupList[0].children.every((function(e){return e.id===h.id}));m&&""!=e.groupList[0].children||(i={name:h.name,id:h.id,status:1,children:[{group_desc:e.group_desc}],group_order:1},e.groupList[0].children.push(i))}e.group[0]=e.groupList[0].children,e.groupcolumns=e.group,""==e.name&&(e.name=e.group[0][0].name,e.group_id=e.group[0][0].id,e.group_order=e.group[0][0].group_order),console.log(e.groupList[0],999);var _=e.group[0].length;e.name==e.group[0][_-1].name&&(e.name=e.group[0][_-1].name,e.group_id=e.group[0][_-1].id,uni.setStorageSync("pictures","")),e.getPictures()}})).catch((function(t){console.log(t),e.$api.msg("数据请求失败")}))},getImgUrl:function(t){return e.baseImg+"/"+t},delPictures:function(e){var t=this;uni.showModal({title:"提示",content:"确定删除该图片吗？",success:function(i){if(i.confirm){var n={user_id:JSON.parse(uni.getStorageSync("userInfo")).user_id,pic_id:e};(0,a.delPictures)(n).then((function(e){2e4===e.code?(t.$api.msg("删除成功"),t.getPictures()):t.$api.msg(e.msg)})).catch((function(e){t.$api.msg("删除失败")}))}}})}}});t.default=r}).call(this,i("c8ba"))},b85c:function(e,t,i){"use strict";i("7a82"),Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){var i="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!i){if(Array.isArray(e)||(i=(0,n.default)(e))||t&&e&&"number"===typeof e.length){i&&(e=i);var o=0,a=function(){};return{s:a,n:function(){return o>=e.length?{done:!0}:{done:!1,value:e[o++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var r,u=!0,s=!1;return{s:function(){i=i.call(e)},n:function(){var e=i.next();return u=e.done,e},e:function(e){s=!0,r=e},f:function(){try{u||null==i["return"]||i["return"]()}finally{if(s)throw r}}}},i("a4d3"),i("e01a"),i("d3b7"),i("d28b"),i("3ca3"),i("ddb0"),i("d9e2"),i("d401");var n=function(e){return e&&e.__esModule?e:{default:e}}(i("06c5"))},dae1:function(e,t,i){var n=i("f4ee");n.__esModule&&(n=n.default),"string"===typeof n&&(n=[[e.i,n,""]]),n.locals&&(e.exports=n.locals);var o=i("4f06").default;o("69a44895",n,!0,{sourceMap:!1,shadowMode:!1})},e357:function(e,t,i){"use strict";i.r(t);var n=i("4b3a"),o=i("4158");for(var a in o)["default"].indexOf(a)<0&&function(e){i.d(t,e,(function(){return o[e]}))}(a);i("0ffb");var r=i("f0c5"),u=Object(r["a"])(o["default"],n["b"],n["c"],!1,null,"f1313764",null,!1,n["a"],void 0);t["default"]=u.exports},f4ee:function(e,t,i){var n=i("24fb");t=n(!1),t.push([e.i,".chat_cont[data-v-f1313764]{padding:%?30?%}.chat_cont .cont_li[data-v-f1313764]{padding:%?25?%;background:#fff;border-radius:%?15?%}.top[data-v-f1313764]{display:flex;justify-content:space-between;margin-bottom:%?24?%}.top .tag[data-v-f1313764]{color:#1f64ff;font-size:%?26?%;font-weight:400}.txt[data-v-f1313764]{color:#202123;font-size:%?28?%;font-weight:500}.picList[data-v-f1313764]{display:flex;flex-wrap:wrap}.item[data-v-f1313764]{margin-bottom:%?32?%;width:33%}.item .pic[data-v-f1313764]{width:%?160?%;height:%?160?%;position:relative}.item .pic .avatar[data-v-f1313764]{width:100%;height:100%}.item .txt[data-v-f1313764]{color:#666;font-size:%?24?%;font-weight:400;margin:%?16?% 0 %?20?% 0;width:%?160?%;overflow:hidden;white-space:nowrap;text-overflow:ellipsis}.item .del[data-v-f1313764]{position:absolute;right:0;top:0;width:%?40?%;height:%?40?%}.item .del .delicon[data-v-f1313764]{width:100%;height:100%}.editTag[data-v-f1313764]{width:%?144?%;height:%?48?%;border-radius:%?6?%;border:%?2?% solid #1f64ff;color:#1f64ff;font-size:%?24?%;font-weight:400;display:flex;justify-content:center;align-items:center}",""]),e.exports=t}}]);